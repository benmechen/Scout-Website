/*
 * jQuery dateDropDowns
 *
 * url		http://http://www.amdonnelly.co.uk/things/date-drop-down-lists.aspx
 * author	Alan Donnelly 2011
 * version	1.0.3
 * license	MIT and GPL licenses
 */
(function (a) { a.fn.dateDropDowns = function (l) { var e = { dateFormat: "dd-mm-yy", monthNames: "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "), yearStart: "1900", yearEnd: (new Date).getFullYear(), defaultCurrentDate: !1 }; l = a.extend(e, l); return this.each(function () { function p() { var b = d.getMonth() + 1, q = "", m = 1; _daysInMonth = r(b, d.getFullYear()) + 1; a("#" + f + "_list").children().length < _daysInMonth ? m = a("#" + f + "_list").children().length + 1 : a("#" + f + "_list").children().remove(); for (_x = m; _x < _daysInMonth; _x++) b = d.getDate() == _x ? "selected='true'" : "", q += "<option value='" + _x + "' " + b + ">" + _x + "</option>"; a("#" + f + "_list").append(q) } function r(b, a) { var d = 31; 4 == b || 6 == b || 9 == b || 11 == b ? d = 30 : 2 == b && (d = 0 == a % 4 ? 29 : 28); return d } function n() { var b = d.getDate(), a = d.getMonth() + 1, m = d.getFullYear(), c = e.dateFormat; -1 < c.indexOf("DD") && 2 > b.toString().length && (b = "0" + b); -1 < c.indexOf("MM") && 2 > a.toString().length && (a = "0" + a); c = e.dateFormat.toLowerCase(); c = c.replace("dd", b); c = c.replace("mm", a); c = c.replace("yy", m); k.val(c) } var k = a(this); k.html(); var c = k.attr("id") + "_dateLists", f = c + "_day", h = c + "_month", g = c + "_year", l = k.val(), d = new Date, s = -1 < e.dateFormat.indexOf("/") ? "/" : -1 < e.dateFormat.indexOf(".") ? "." : "-"; (function () { if (0 < l.length) { var b = e.dateFormat.split(s), a = l.split(s), c = new Date; for (_x = 0; _x < a.length; _x++) -1 < b[_x].toLowerCase().indexOf("d") ? c.setDate(a[_x]) : -1 < b[_x].toLowerCase().indexOf("m") ? c.setMonth(a[_x] - 1) : -1 < b[_x].toLowerCase().indexOf("y") && c.setYear(a[_x]); d = c } else d = new Date(e.yearStart, 1, 1); 1 == e.defaultCurrentDate && (d = new Date); n() })(); (function () { var b = e.dateFormat.split(s), d = k; k.replaceWith("<div id='" + c + "' class='dateLists_container'></div>"); for (_x = 0; _x < b.length; _x++) -1 < b[_x].toLowerCase().indexOf("d") ? (a("#" + c).append("<div id='" + f + "' class='day_container'>"), a("#" + f).append("<select id='" + f + "_list' name='" + f + "_list' class='list'></select>"), a("#" + c).append("</div>")) : -1 < b[_x].toLowerCase().indexOf("m") ? (a("#" + c).append("<div id='" + h + "' class='month_container'>"), a("#" + h).append("<select id='" + h + "_list' name='" + h + "_list' class='list'></select>"), a("#" + c).append("</div>")) : -1 < b[_x].toLowerCase().indexOf("y") && (a("#" + c).append("<div id='" + g + "' class='year_container'>"), a("#" + g).append("<select id='" + g + "_list' name='" + g + "_list' class='list'></select>"), a("#" + c).append("</div>")); a("#" + c).append(d); k.hide() })(); p(); (function () { a("#" + h + "_list").children().remove(); for (_x = 0; 12 > _x; _x++) { var b = d.getMonth() == _x ? "selected='true'" : ""; a("#" + h + "_list").append("<option value='" + _x + "' " + b + ">" + e.monthNames[_x] + "</option>") } })(); (function () { a("#" + g + "_list").children().remove(); var b = parseInt(e.yearStart), c = parseInt(e.yearEnd); if (c > b) for (_x = b; _x < c + 1; _x++) b = d.getFullYear() == _x ? "selected='true'" : "", a("#" + g + "_list").append("<option value='" + _x + "' " + b + ">" + _x + "</option>"); else for (_y = b; 2005 < _y; _y--) b = d.getFullYear() == _y ? "selected='true'" : "", a("#" + g + "_list").append("<option value='" + _y + "' " + b + ">" + _y + "</option>") })(); (function () { a("#" + f + "_list").change(function () { d.setDate(a("#" + f + "_list").val()); n() }); a("#" + h + "_list").change(function () { var b = parseInt(a("#" + h + "_list").val()), c = d.getDate(); _daysInMonth = r(b + 1, d.getFullYear()); c > _daysInMonth && (c = _daysInMonth); d = new Date(d.getFullYear(), b, c, 0, 0, 0, 0); p(); n() }); a("#" + g + "_list").change(function () { var b = a("#" + g + "_list").val(), c = d.getDate(), e = d.getMonth(); _daysInMonth = r(e + 1, b); c > _daysInMonth && (c = _daysInMonth); d = new Date(b, e, c, 0, 0, 0, 0); p(); n() }) })() }) } })(jQuery);